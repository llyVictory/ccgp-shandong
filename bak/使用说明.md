# 山东政府采购爬虫系统 - 便携版

## 📦 系统介绍

本系统用于自动抓取山东省政府采购网的采购意向公开信息，支持：

- ✅ Web界面操作，无需编程
- ✅ 定时任务自动执行
- ✅ 数据导出为Excel格式
- ✅ 便携式设计，U盘即插即用

---

## 🚀 快速开始（3步）

### 1️⃣ 系统要求

**必须安装**：

- ✅ **Python 3.8+**
  - 下载地址：<https://www.python.org/downloads/>
  - ⚠️ 安装时务必勾选 **"Add Python to PATH"**
  
- ✅ **Google Chrome浏览器**
  - 下载地址：<https://www.google.com/chrome/>

**系统要求**：

- Windows 10/11 (64位)
- 至少 2GB 可用内存
- 至少 500MB 可用磁盘空间

---

### 2️⃣ 首次使用

**第一次使用需要初始化**：

1. 双击运行 `首次安装.bat`
2. 等待依赖安装完成（约3-5分钟）
3. 看到"安装完成"提示后关闭

---

### 3️⃣ 启动系统

1. 双击运行 `启动爬虫.bat`
2. 浏览器自动打开控制台页面
3. 开始使用！

---

## 📖 使用说明

### 立即执行一次

1. 在Web控制台选择时间范围
2. 点击"立即执行一次"按钮
3. 浏览器自动打开并开始爬取
4. 完成后下载Excel文件

### 创建定时任务

1. 设置执行时间（例如：16:00）
2. 设置保存路径（例如：D:\spider_downloads）
3. 点击"创建/更新定时任务"
4. 每天自动执行，无需人工干预

### 数据导出

数据自动保存为Excel格式，包含以下字段：

- 序号、地区、标题、发布人、发布时间
- 子序号、采购项目名称、采购需求概况、预算金额
- 拟面向中小企业预留、预计采购时间、备注、Link

---

## 🔧 常见问题

### Q1：提示"未检测到Python"

**解决**：

- 安装Python后重启电脑
- 确认安装时勾选了"Add Python to PATH"
- 打开CMD输入 `python --version` 验证

### Q2：Chrome自动打开后卡住不动

**解决**：

- 验证码识别可能失败，系统会自动重试（最多5次）
- 如果一直卡住，可能是网络问题，请检查网络连接

### Q3：定时任务没有执行

**解决**：

- 确保`启动爬虫.bat`窗口保持打开状态
- 服务关闭则定时任务停止
- 建议设置开机自启动

### Q4：端口8080被占用

**解决**：

- 打开 `server.py`
- 修改最后一行端口号：`port=8090`
- 访问地址改为：<http://localhost:8090>

### Q5：想要迁移到其他电脑

**解决**：

- 直接复制整个文件夹到U盘
- 在新电脑上重新运行"首次安装.bat"
- 配置会自动保留

---

## 📁 文件结构

```
bid_spider/
├── 启动爬虫.bat          # 主启动脚本
├── 首次安装.bat          # 初始化脚本
├── 使用说明.md           # 本文档
├── requirements.txt      # 依赖列表
├── server.py            # 后端服务
├── spider/              # 爬虫核心代码
├── static/              # Web界面
├── venv/                # 虚拟环境（首次安装后生成）
├── downloads/           # 默认下载目录
└── schedule_config.json # 定时任务配置（自动生成）
```

---

## 🛡️ 数据安全

- ✅ 所有数据存储在本地
- ✅ 不上传任何信息到外部服务器
- ✅ 源代码完全开放可审计

---

## 📞 技术支持

遇到问题？请提供以下信息：

1. 错误截图
2. Python版本（CMD输入：`python --version`）
3. Chrome版本（浏览器菜单 -> 帮助 -> 关于Google Chrome）
4. 具体操作步骤

---

## 📝 更新日志

### v1.0 (2026-02-04)

- ✅ 完整爬虫功能
- ✅ Web控制台界面
- ✅ 定时任务支持
- ✅ 5次验证码重试机制
- ✅ 自动关闭浏览器
- ✅ 便携式打包

---

## ⚖️ 免责声明

本软件仅供学习交流使用，请遵守目标网站的robots.txt协议和使用条款。
使用本软件产生的任何法律责任由使用者自行承担。

---

**祝使用愉快！** 🎉
